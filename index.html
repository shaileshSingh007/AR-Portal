<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR Model Viewer with Distance</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>
  <h1>AR Model Viewer with Distance Trigger</h1>
  <p>Move the camera closer to the model to trigger the event.</p>

  <!-- AR Model Viewer s-->
  <model-viewer
    id="model-viewer"
    src="portal.glb"
    ios-src="path/to/your-model.usdz"
    alt="3D model"
    ar
    ar-modes="quick-look"
    camera-controls
    style="width: 100%; height: 500px;">
  </model-viewer>

  <script>
    const modelViewer = document.querySelector('#model-viewer');
    const triggerDistance = 2; // Set the distance threshold in meters

    let previousCameraPosition = { x: 0, y: 0, z: 0 };

    modelViewer.addEventListener('camera-position-changed', () => {
      const cameraPosition = modelViewer.getCameraPosition();

      // Estimate the distance (using Euclidean distance formula)
      const distance = Math.sqrt(
        Math.pow(cameraPosition.x - previousCameraPosition.x, 2) +
        Math.pow(cameraPosition.y - previousCameraPosition.y, 2) +
        Math.pow(cameraPosition.z - previousCameraPosition.z, 2)
      );

      console.log(`Current Distance: ${distance.toFixed(2)} meters`);

      // Trigger event if within a certain range (distance threshold)
      if (distance <= triggerDistance) {
        console.log('Camera is within range of the model!');
        triggerEvent();  // Trigger your custom event here
      }

      // Update previous camera position
      previousCameraPosition = cameraPosition;
    });

    // Custom event handler
    function triggerEvent() {
      alert('Camera is close enough to the model!');
    }
  </script>
</body>
</html>